<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-2.7 docs-doc-page docs-doc-id-usage/workflow-syntax" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Workflow syntax | Woodpecker CI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://woodpecker-ci.org/docs/usage/workflow-syntax"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.7"><meta data-rh="true" name="docsearch:version" content="2.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.7"><meta data-rh="true" property="og:title" content="Workflow syntax | Woodpecker CI"><meta data-rh="true" name="description" content="The Workflow section defines a list of steps to build, test and deploy your code. The steps are executed serially in the order in which they are defined. If a step returns a non-zero exit code, the workflow and therefore the entire pipeline terminates immediately and returns an error status."><meta data-rh="true" property="og:description" content="The Workflow section defines a list of steps to build, test and deploy your code. The steps are executed serially in the order in which they are defined. If a step returns a non-zero exit code, the workflow and therefore the entire pipeline terminates immediately and returns an error status."><link data-rh="true" rel="canonical" href="https://woodpecker-ci.org/docs/usage/workflow-syntax"><link data-rh="true" rel="alternate" href="https://woodpecker-ci.org/docs/usage/workflow-syntax" hreflang="en"><link data-rh="true" rel="alternate" href="https://woodpecker-ci.org/docs/usage/workflow-syntax" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Woodpecker CI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Woodpecker CI Atom Feed">





<link rel="icon" href="/img/favicon.ico" sizes="any">
<link rel="icon" href="/img/favicon.svg" type="image/svg+xml">



<link href="https://floss.social/@WoodpeckerCI" rel="me"><link rel="stylesheet" href="/assets/css/styles.01ae3d06.css">
<script src="/assets/js/runtime~main.05feab87.js" defer="defer"></script>
<script src="/assets/js/main.63da6e2f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_wTNM" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_Km0O" style="background-color:var(--ifm-color-primary);color:var(--ifm-color-gray-900)" role="banner"><div class="announcementBarPlaceholder__IDs"></div><div class="content_lY4o announcementBarContent_ToCH"> If you like Woodpecker-CI, <a href="https://github.com/woodpecker-ci/woodpecker" rel="noopener noreferrer" target="_blank">give us a star on GitHub</a> ! ⭐️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_txxl announcementBarClose_ZciJ"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Woodpecker Logo" class="themedComponent_GOZW themedComponent--light_R1Gr"><img src="/img/logo.svg" alt="Woodpecker Logo" class="themedComponent_GOZW themedComponent--dark_FbPO"></div><b class="navbar__title text--truncate">Woodpecker</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/plugins">Plugins</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/migrations">Migrations</a></li><li><a class="dropdown__link" href="/awesome">Awesome</a></li><li><a class="dropdown__link" href="/api">API</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/usage/workflow-syntax">2.7.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/usage/workflow-syntax">Next 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/usage/workflow-syntax">2.7.x</a></li><li><a class="dropdown__link" href="/docs/2.6/usage/workflow-syntax">2.6.x 💀</a></li><li><a class="dropdown__link" href="/docs/2.5/usage/workflow-syntax">2.5.x 💀</a></li><li><a class="dropdown__link" href="/docs/1.0/intro">1.0.x 💀</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><a href="https://github.com/woodpecker-ci/woodpecker" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://opencollective.com/woodpecker-ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">🧡 Sponsor Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_kOyt colorModeToggle_S2iM"><button class="clean-btn toggleButton_Q281 toggleButtonDisabled_PZ20" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_ySjX"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_XXOE"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_T_FD"><div class="navbar__search searchBarContainer_OrLP" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_VUiR searchBarLoadingRing_i97R"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_M5CM"><div class="docsWrapper_nEBH"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_W3Bj" type="button"></button><div class="docRoot_lino"><aside class="theme-doc-sidebar-container docSidebarContainer_FMip"><div class="sidebarViewport_cSxa"><div class="sidebar_q9hC"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_tj9m menuWithAnnouncementBar_ADpj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Welcome to Woodpecker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/usage/intro">Usage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/intro">Your first pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/terminology">Terminology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/usage/workflow-syntax">Workflow syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/workflows">Workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/matrix-workflows">Matrix workflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/secrets">Secrets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/registries">Registries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/cron">Cron</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/environment">Environment variables</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/usage/plugins/overview">Plugins</a><button aria-label="Expand sidebar category &#x27;Plugins&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/services">Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/volumes">Volumes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/linter">Linter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/project-settings">Project settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/badges">Status Badges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/advanced-usage">Advanced usage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/troubleshooting">Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/administration/getting-started">Administration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/migrations">Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/awesome">Awesome Woodpecker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/development/getting-started">Development</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_NLNY"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_jlFd"><div class="docItemContainer_hYGf"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_CDhb" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_cCXP"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Usage</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Workflow syntax</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.7.x</span><div class="tocCollapsible_ueTt theme-doc-toc-mobile tocMobile_zvD0"><button type="button" class="clean-btn tocCollapsibleButton_TOSy">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Workflow syntax</h1></header>
<p>The Workflow section defines a list of steps to build, test and deploy your code. The steps are executed serially in the order in which they are defined. If a step returns a non-zero exit code, the workflow and therefore the entire pipeline terminates immediately and returns an error status.</p>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>An exception to this rule are steps with a <a href="#status"><code>status: [failure]</code></a> condition, which ensures that they are executed in the case of a failed run.</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>We support most of YAML 1.2, but preserve some behavior from 1.1 for backward compatibility.
Read more at: <a href="https://github.com/go-yaml/yaml/tree/v3" target="_blank" rel="noopener noreferrer">https://github.com/go-yaml/yaml</a></p></div></div>
<p>Example steps:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> go test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm run test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm run build</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the above example we define two steps, <code>frontend</code> and <code>backend</code>. The names of these steps are completely arbitrary.</p>
<p>The name is optional, if not added the steps will be numerated.</p>
<p>Another way to name a step is by using dictionaries:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> go test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frontend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm run test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm run build</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="skip-commits">Skip Commits<a href="#skip-commits" class="hash-link" aria-label="Direct link to Skip Commits" title="Direct link to Skip Commits">​</a></h2>
<p>Woodpecker gives the ability to skip individual commits by adding <code>[SKIP CI]</code> or <code>[CI SKIP]</code> to the commit message. Note this is case-insensitive.</p>
<div class="language-bash codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-bash codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> commit </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;updated README [CI SKIP]&quot;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="steps">Steps<a href="#steps" class="hash-link" aria-label="Direct link to Steps" title="Direct link to Steps">​</a></h2>
<p>Every step of your workflow executes commands inside a specified container.<br>
The defined steps are executed in sequence by default, if they should run in parallel you can use <a href="/docs/usage/workflow-syntax#depends_on"><code>depends_on</code></a>.<br>
The associated commit is checked out with git to a workspace which is mounted to every step of the workflow as the working directory.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="file-changes-are-incremental">File changes are incremental<a href="#file-changes-are-incremental" class="hash-link" aria-label="Direct link to File changes are incremental" title="Direct link to File changes are incremental">​</a></h3>
<ul>
<li>Woodpecker clones the source code in the beginning of the workflow</li>
<li>Changes to files are persisted through steps as the same volume is mounted to all steps</li>
</ul>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_hMkp">.woodpecker.yaml</div><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> debian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> echo &quot;test content&quot; </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> debian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> cat myfile</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="image"><code>image</code><a href="#image" class="hash-link" aria-label="Direct link to image" title="Direct link to image">​</a></h3>
<p>Woodpecker pulls the defined image and uses it as environment to execute the workflow step commands, for plugins and for service containers.</p>
<p>When using the <code>local</code> backend, the <code>image</code> entry is used to specify the shell, such as Bash or Fish, that is used to run the commands.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: golang:1.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: plugins/docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    repo: foo/bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: database</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: mysql</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Woodpecker supports any valid Docker image from any Docker registry:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> golang</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> library/golang</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> index.docker.io/library/golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> index.docker.io/library/golang</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1.7</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Woodpecker does not automatically upgrade container images. Example configuration to always pull the latest image when updates are available:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    pull: true</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Learn more how you can use images from <a href="/docs/usage/registries">different registries</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="commands"><code>commands</code><a href="#commands" class="hash-link" aria-label="Direct link to commands" title="Direct link to commands">​</a></h3>
<p>Commands of every step are executed serially as if you would enter them into your local shell.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is no magic here. The above commands are converted to a simple shell script. The commands in the above example are roughly converted to the below script:</p>
<div class="language-bash codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-bash codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go </span><span class="token builtin class-name">test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The above shell script is then executed as the container entrypoint. The below docker command is an (incomplete) example of how the script is executed:</p>
<div class="language-bash codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-bash codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--entrypoint</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">build.sh golang</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>Only build steps can define commands. You cannot use commands with plugins or services.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="entrypoint"><code>entrypoint</code><a href="#entrypoint" class="hash-link" aria-label="Direct link to entrypoint" title="Direct link to entrypoint">​</a></h3>
<p>Allows you to specify the entrypoint for containers. Note that this must be a list of the command and its arguments (e.g. <code>[&quot;/bin/sh&quot;, &quot;-c&quot;]</code>).</p>
<p>If you define <a href="#commands"><code>commands</code></a>, the default entrypoint will be <code>[&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo $CI_SCRIPT | base64 -d | /bin/sh -e&quot;]</code>.
You can also use a custom shell with <code>CI_SCRIPT</code> (Base64-encoded) if you set <code>commands</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="environment"><code>environment</code><a href="#environment" class="hash-link" aria-label="Direct link to environment" title="Direct link to environment">​</a></h3>
<p>Woodpecker provides the ability to pass environment variables to individual steps.</p>
<p>For more details, check the <a href="/docs/usage/environment">environment docs</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="secrets"><code>secrets</code><a href="#secrets" class="hash-link" aria-label="Direct link to secrets" title="Direct link to secrets">​</a></h3>
<p>Woodpecker provides the ability to store named parameters external to the YAML configuration file, in a central secret store. These secrets can be passed to individual steps of the workflow at runtime.</p>
<p>For more details, check the <a href="/docs/usage/secrets">secrets docs</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="failure"><code>failure</code><a href="#failure" class="hash-link" aria-label="Direct link to failure" title="Direct link to failure">​</a></h3>
<p>Some of the steps may be allowed to fail without causing the whole workflow and therefore pipeline to report a failure (e.g., a step executing a linting check). To enable this, add <code>failure: ignore</code> to your step. If Woodpecker encounters an error while executing the step, it will report it as failed but still executes the next steps of the workflow, if any, without affecting the status of the workflow.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    failure: ignore</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="when---conditional-execution"><code>when</code> - Conditional Execution<a href="#when---conditional-execution" class="hash-link" aria-label="Direct link to when---conditional-execution" title="Direct link to when---conditional-execution">​</a></h3>
<p>Woodpecker supports defining a list of conditions for a step by using a <code>when</code> block. If at least one of the conditions in the <code>when</code> block evaluate to true the step is executed, otherwise it is skipped. A condition is evaluated to true if <em>all</em> subconditions are true.
A condition can be a check like:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      channel: dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - event: pull_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        repo: test/test</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - event: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        branch: main</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>slack</code> step is executed if one of these conditions is met:</p>
<ol>
<li>The pipeline is executed from a pull request in the repo <code>test/test</code></li>
<li>The pipeline is executed from a push to <code>main</code></li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="repo"><code>repo</code><a href="#repo" class="hash-link" aria-label="Direct link to repo" title="Direct link to repo">​</a></h4>
<p>Example conditional execution by repository:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      channel: dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - repo: test/test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="branch"><code>branch</code><a href="#branch" class="hash-link" aria-label="Direct link to branch" title="Direct link to branch">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>Branch conditions are not applied to tags.</p></div></div>
<p>Example conditional execution by branch:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      channel: dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - branch: main</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>The step now triggers on main branch, but also if the target branch of a pull request is <code>main</code>. Add an event condition to limit it further to pushes on main only.</p>
</blockquote>
<p>Execute a step if the branch is <code>main</code> or <code>develop</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">branch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> develop</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Execute a step if the branch starts with <code>prefix/*</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">branch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prefix/*</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The branch matching is done using <a href="https://github.com/bmatcuk/doublestar/#usage" target="_blank" rel="noopener noreferrer">doublestar</a>, note that a pattern starting with <code>*</code> should be put between quotes and a literal <code>/</code> needs to be escaped. A few examples:</p>
<ul>
<li><code>*\\/*</code> to match patterns with exactly 1 <code>/</code></li>
<li><code>*\\/**</code> to match patters with at least 1 <code>/</code></li>
<li><code>*</code> to match patterns without <code>/</code></li>
<li><code>**</code> to match everything</li>
</ul>
<p>Execute a step using custom include and exclude logic:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">branch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">include</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> release/*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">exclude</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">release/1.0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> release/1.1.*</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="event"><code>event</code><a href="#event" class="hash-link" aria-label="Direct link to event" title="Direct link to event">​</a></h4>
<p>Available events: <code>push</code>, <code>pull_request</code>, <code>pull_request_closed</code>, <code>tag</code>, <code>release</code>, <code>deployment</code>, <code>cron</code>, <code>manual</code></p>
<p>Execute a step if the build event is a <code>tag</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tag</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Execute a step if the pipeline event is a <code>push</code> to a specified branch:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token plain">when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> - event: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">   branch: main</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Execute a step for multiple events:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> deployment</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="cron"><code>cron</code><a href="#cron" class="hash-link" aria-label="Direct link to cron" title="Direct link to cron">​</a></h4>
<p>This filter <strong>only</strong> applies to cron events and filters based on the name of a cron job.</p>
<p>Make sure to have a <code>event: cron</code> condition in the <code>when</code>-filters as well.</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cron</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sync_* </span><span class="token comment" style="color:#999988;font-style:italic"># name of your cron job</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="/docs/usage/cron">Read more about cron</a></p>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="ref"><code>ref</code><a href="#ref" class="hash-link" aria-label="Direct link to ref" title="Direct link to ref">​</a></h4>
<p>The <code>ref</code> filter compares the git reference against which the workflow is executed.
This allows you to filter, for example, tags that must start with <strong>v</strong>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> refs/tags/v*</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="status"><code>status</code><a href="#status" class="hash-link" aria-label="Direct link to status" title="Direct link to status">​</a></h4>
<p>There are use cases for executing steps on failure, such as sending notifications for failed workflow / pipeline. Use the status constraint to execute steps even when the workflow fails:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      channel: dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      - status: [ success, failure ]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="platform"><code>platform</code><a href="#platform" class="hash-link" aria-label="Direct link to platform" title="Direct link to platform">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>This condition should be used in conjunction with a <a href="/docs/usage/matrix-workflows#example-matrix-pipeline-using-multiple-platforms">matrix</a> workflow as a regular workflow will only be executed by a single agent which only has one arch.</p></div></div>
<p>Execute a step for a specific platform:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">platform</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> linux/amd64</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Execute a step for a specific platform using wildcards:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">platform</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">linux/*</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> windows/amd64</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="matrix"><code>matrix</code><a href="#matrix" class="hash-link" aria-label="Direct link to matrix" title="Direct link to matrix">​</a></h4>
<p>Execute a step for a single matrix permutation:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">matrix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">GO_VERSION</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">REDIS_VERSION</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.8</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="instance"><code>instance</code><a href="#instance" class="hash-link" aria-label="Direct link to instance" title="Direct link to instance">​</a></h4>
<p>Execute a step only on a certain Woodpecker instance matching the specified hostname:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> stage.woodpecker.company.com</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="path"><code>path</code><a href="#path" class="hash-link" aria-label="Direct link to path" title="Direct link to path">​</a></h4>
<div class="theme-admonition theme-admonition-info admonition_zUav alert alert--info"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_qLe4"><p>Path conditions are applied only to <strong>push</strong> and <strong>pull_request</strong> events.
It is currently <strong>only available</strong> for GitHub, GitLab and Gitea (version 1.18.0 and newer)</p></div></div>
<p>Execute a step only on a pipeline with certain files being changed:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;src/*&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can use <a href="https://github.com/bmatcuk/doublestar#patterns" target="_blank" rel="noopener noreferrer">glob patterns</a> to match the changed files and specify if the step should run if a file matching that pattern has been changed <code>include</code> or if some files have <strong>not</strong> been changed <code>exclude</code>.</p>
<p>For pipelines without file changes (empty commits or on events without file changes like <code>tag</code>), you can use <code>on_empty</code> to set whether this condition should be <strong>true</strong> <em>(default)</em> or <strong>false</strong> in these cases.</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">include</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;.woodpecker/*.yaml&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*.ini&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">exclude</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;*.md&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;docs/**&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">ignore_message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;[ALL]&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">on_empty</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_zUav alert alert--info"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_qLe4"><p>Passing a defined ignore-message like <code>[ALL]</code> inside the commit message will ignore all path conditions and the <code>on_empty</code> setting.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_QmVW" id="evaluate"><code>evaluate</code><a href="#evaluate" class="hash-link" aria-label="Direct link to evaluate" title="Direct link to evaluate">​</a></h4>
<p>Execute a step only if the provided evaluate expression is equal to true. Both built-in <a href="/docs/usage/environment#built-in-environment-variables"><code>CI_</code></a> and custom variables can be used inside the expression.</p>
<p>The expression syntax can be found in <a href="https://github.com/expr-lang/expr/blob/master/docs/language-definition.md" target="_blank" rel="noopener noreferrer">the docs</a> of the underlying library.</p>
<p>Run on pushes to the default branch for the repository <code>owner/repo</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">evaluate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CI_PIPELINE_EVENT == &quot;push&quot; &amp;&amp; CI_REPO == &quot;owner/repo&quot; &amp;&amp; CI_COMMIT_BRANCH == CI_REPO_DEFAULT_BRANCH&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run on commits created by user <code>woodpecker-ci</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">evaluate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CI_COMMIT_AUTHOR == &quot;woodpecker-ci&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Skip all commits containing <code>please ignore me</code> in the commit message:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">evaluate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;not (CI_COMMIT_MESSAGE contains &quot;please ignore me&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run on pull requests with the label <code>deploy</code>:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">evaluate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CI_COMMIT_PULL_REQUEST_LABELS contains &quot;deploy&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Skip step only if <code>SKIP=true</code>, run otherwise or if undefined:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">evaluate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SKIP != &quot;true&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="depends_on"><code>depends_on</code><a href="#depends_on" class="hash-link" aria-label="Direct link to depends_on" title="Direct link to depends_on">​</a></h3>
<p>Normally steps of a workflow are executed serially in the order in which they are defined. As soon as you set <code>depends_on</code> for a step a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" target="_blank" rel="noopener noreferrer">directed acyclic graph</a> will be used and all steps of the workflow will be executed in parallel besides the steps that have a dependency set to another step using <code>depends_on</code>:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build # build will be executed immediately</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      repo: foo/bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    depends_on: [build, test] # deploy will be executed after build and test finished</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: test # test will be executed immediately as no dependencies are set</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>You can define a step to start immediately without dependencies by adding an empty <code>depends_on: []</code>. By setting <code>depends_on</code> on a single step all other steps will be immediately executed as well if no further dependencies are specified.</p><div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> check code format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mstruebing/editorconfig</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">checker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># enable parallel steps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="volumes"><code>volumes</code><a href="#volumes" class="hash-link" aria-label="Direct link to volumes" title="Direct link to volumes">​</a></h3>
<p>Woodpecker gives the ability to define Docker volumes in the YAML. You can use this parameter to mount files or folders on the host machine into your containers.</p>
<p>For more details check the <a href="/docs/usage/volumes">volumes docs</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="detach"><code>detach</code><a href="#detach" class="hash-link" aria-label="Direct link to detach" title="Direct link to detach">​</a></h3>
<p>Woodpecker gives the ability to detach steps to run them in background until the workflow finishes.</p>
<p>For more details check the <a href="/docs/usage/services#detachment">service docs</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="directory"><code>directory</code><a href="#directory" class="hash-link" aria-label="Direct link to directory" title="Direct link to directory">​</a></h3>
<p>Using <code>directory</code>, you can set a subdirectory of your repository or an absolute path inside the Docker container in which your commands will run.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="services"><code>services</code><a href="#services" class="hash-link" aria-label="Direct link to services" title="Direct link to services">​</a></h2>
<p>Woodpecker can provide service containers. They can for example be used to run databases or cache containers during the execution of workflow.</p>
<p>For more details check the <a href="/docs/usage/services">services docs</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="workspace"><code>workspace</code><a href="#workspace" class="hash-link" aria-label="Direct link to workspace" title="Direct link to workspace">​</a></h2>
<p>The workspace defines the shared volume and working directory shared by all workflow steps.
The default workspace base is <code>/woodpecker</code> and the path is extended with the repository URL (<code>src/{url-without-schema}</code>).
So an example would be <code>/woodpecker/src/github.com/octocat/hello-world</code>.</p>
<p>The workspace can be customized using the workspace block in the YAML file:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">workspace:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  base: /go</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  path: src/github.com/octocat/hello-world</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go get</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_zUav alert alert--secondary"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_qLe4"><p>Plugins will always have the workspace base at <code>/woodpecker</code></p></div></div>
<p>The base attribute defines a shared base volume available to all steps. This ensures your source code, dependencies and compiled binaries are persisted and shared between steps.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">workspace:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  base: /go</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  path: src/github.com/octocat/hello-world</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: deps</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go get</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: node:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This would be equivalent to the following docker commands:</p>
<div class="language-bash codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-bash codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> volume create my-named-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--volume</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-named-volume:/go golang:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--volume</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">my-named-volume:/go node:latest</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The path attribute defines the working directory of your build. This is where your code is cloned and will be the default working directory of every step in your build process. The path must be relative and is combined with your base path.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">workspace:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  base: /go</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  path: src/github.com/octocat/hello-world</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-bash codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/octocat/hello-world </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /go/src/github.com/octocat/hello-world</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="matrix-1"><code>matrix</code><a href="#matrix-1" class="hash-link" aria-label="Direct link to matrix-1" title="Direct link to matrix-1">​</a></h2>
<p>Woodpecker has integrated support for matrix builds. Woodpecker executes a separate build task for each combination in the matrix, allowing you to build and test a single commit against multiple configurations.</p>
<p>For more details check the <a href="/docs/usage/matrix-workflows">matrix build docs</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="labels"><code>labels</code><a href="#labels" class="hash-link" aria-label="Direct link to labels" title="Direct link to labels">​</a></h2>
<p>You can set labels for your workflow to select an agent to execute the workflow on. An agent will pick up and run a workflow when <strong>every</strong> label assigned to it matches the agents labels.</p>
<p>To set additional agent labels, check the <a href="/docs/administration/agent-config#woodpecker_filter_labels">agent configuration options</a>. Agents will have at least four default labels: <code>platform=agent-os/agent-arch</code>, <code>hostname=my-agent</code>, <code>backend=docker</code> (type of the agent backend) and <code>repo=*</code>. Agents can use a <code>*</code> as a wildcard for a label. For example <code>repo=*</code> will match every repo.</p>
<p>Workflow labels with an empty value will be ignored.
By default, each workflow has at least the <code>repo=your-user/your-repo-name</code> label. If you have set the <a href="#platform">platform attribute</a> for your workflow it will have a label like <code>platform=your-os/your-arch</code> as well.</p>
<p>You can add additional labels as a key value map:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  location: europe # only agents with `location=europe` or `location=*` will be used</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  weather: sun</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  hostname: &quot;&quot; # this label will be ignored as it is empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="filter-by-platform">Filter by platform<a href="#filter-by-platform" class="hash-link" aria-label="Direct link to Filter by platform" title="Direct link to Filter by platform">​</a></h3>
<p>To configure your workflow to only be executed on an agent with a specific platform, you can use the <code>platform</code> key.
Have a look at the official <a href="https://go.dev/doc/install/source" target="_blank" rel="noopener noreferrer">go docs</a> for the available platforms. The syntax of the platform is <code>GOOS/GOARCH</code> like <code>linux/arm64</code> or <code>linux/amd64</code>.</p>
<p>Example:</p>
<p>Assuming we have two agents, one <code>linux/arm</code> and one <code>linux/amd64</code>. Previously this workflow would have executed on <strong>either agent</strong>, as Woodpecker is not fussy about where it runs the workflows. By setting the following option it will only be executed on an agent with the platform <code>linux/arm64</code>.</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  platform: linux/arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  [...]</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="variables"><code>variables</code><a href="#variables" class="hash-link" aria-label="Direct link to variables" title="Direct link to variables">​</a></h2>
<p>Woodpecker supports using <a href="https://yaml.org/spec/1.2.2/#3222-anchors-and-aliases" target="_blank" rel="noopener noreferrer">YAML anchors &amp; aliases</a> as variables in the workflow configuration.</p>
<p>For more details and examples check the <a href="/docs/usage/advanced-usage">Advanced usage docs</a></p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="clone"><code>clone</code><a href="#clone" class="hash-link" aria-label="Direct link to clone" title="Direct link to clone">​</a></h2>
<p>Woodpecker automatically configures a default clone step if not explicitly defined. When using the <code>local</code> backend, the <a href="https://github.com/woodpecker-ci/plugin-git" target="_blank" rel="noopener noreferrer">plugin-git</a> binary must be on your <code>$PATH</code> for the default clone step to work. If not, you can still write a manual clone step.</p>
<p>You can manually configure the clone step in your workflow for customization:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">clone:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  git:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: woodpeckerci/plugin-git</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: golang</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - go test</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example configuration to override depth:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">clone:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: git</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: woodpeckerci/plugin-git</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      partial: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      depth: 50</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example configuration to use a custom clone plugin:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">clone:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: git</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: octocat/custom-git-plugin</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example configuration to clone Mercurial repository:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">clone:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: hg</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    image: plugins/hg</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      path: bitbucket.org/foo/bar</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_QmVW" id="git-submodules">Git Submodules<a href="#git-submodules" class="hash-link" aria-label="Direct link to Git Submodules" title="Direct link to Git Submodules">​</a></h3>
<p>To use the credentials that cloned the repository to clone it&#x27;s submodules, update <code>.gitmodules</code> to use <code>https</code> instead of <code>git</code>:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">[submodule &quot;my-module&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">path = my-module</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">url = git@github.com:octocat/my-module.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">url = https://github.com/octocat/my-module.git</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To use the ssh git url in <code>.gitmodules</code> for users cloning with ssh, and also use the https url in Woodpecker, add <code>submodule_override</code>:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">clone:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: git</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: woodpeckerci/plugin-git</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      recursive: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      submodule_override:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        my-module: https://github.com/octocat/my-module.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> ...</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="skip_clone"><code>skip_clone</code><a href="#skip_clone" class="hash-link" aria-label="Direct link to skip_clone" title="Direct link to skip_clone">​</a></h2>
<p>By default Woodpecker is automatically adding a clone step. This clone step can be configured by the <a href="#clone">clone</a> property. If you do not need a <code>clone</code> step at all you can skip it using:</p>
<div class="language-yaml codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-yaml codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">skip_clone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="when---global-workflow-conditions"><code>when</code> - Global workflow conditions<a href="#when---global-workflow-conditions" class="hash-link" aria-label="Direct link to when---global-workflow-conditions" title="Direct link to when---global-workflow-conditions">​</a></h2>
<p>Woodpecker gives the ability to skip whole workflows (<a href="#when---conditional-execution">not just steps</a>) based on certain conditions by a <code>when</code> block. If all conditions in the <code>when</code> block evaluate to true the workflow is executed, otherwise it is skipped, but treated as successful and other workflows depending on it will still continue.</p>
<p>For more information about the specific filters, take a look at the <a href="#when---conditional-execution">step-specific <code>when</code> filters</a>.</p>
<p>Example conditional execution by branch:</p>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">when:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  branch: main</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: plugins/slack</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    settings:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      channel: dev</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The workflow now triggers on <code>main</code>, but also if the target branch of a pull request is <code>main</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="depends_on-1"><code>depends_on</code><a href="#depends_on-1" class="hash-link" aria-label="Direct link to depends_on-1" title="Direct link to depends_on-1">​</a></h2>
<p>Woodpecker supports to define multiple workflows for a repository. Those workflows will run independent from each other. To depend them on each other you can use the <a href="/docs/usage/workflows#flow-control"><code>depends_on</code></a> keyword.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="runs_on"><code>runs_on</code><a href="#runs_on" class="hash-link" aria-label="Direct link to runs_on" title="Direct link to runs_on">​</a></h2>
<p>Workflows that should run even on failure should set the <code>runs_on</code> tag. See <a href="/docs/usage/workflows#flow-control">here</a> for an example.</p>
<h2 class="anchor anchorWithStickyNavbar_QmVW" id="privileged-mode">Privileged mode<a href="#privileged-mode" class="hash-link" aria-label="Direct link to Privileged mode" title="Direct link to Privileged mode">​</a></h2>
<p>Woodpecker gives the ability to configure privileged mode in the YAML. You can use this parameter to launch containers with escalated capabilities.</p>
<div class="theme-admonition theme-admonition-info admonition_zUav alert alert--info"><div class="admonitionHeading_sWFl"><span class="admonitionIcon_J1ds"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_qLe4"><p>Privileged mode is only available to trusted repositories and for security reasons should only be used in private environments. See <a href="/docs/usage/project-settings#trusted">project settings</a> to enable trusted mode.</p></div></div>
<div class="language-diff codeBlockContainer_ewo0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_HOme"><pre tabindex="0" class="prism-code language-diff codeBlock_yPb2 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FsBZ"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  - name: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - DOCKER_HOST=tcp://docker:2375</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      - docker --tls=false ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">- name: services</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  docker:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    image: docker:dind</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    commands: dockerd-entrypoint.sh --storage-driver=vfs --tls=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    privileged: true</span><br></span></code></pre><div class="buttonGroup_nJjc"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lYVA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yzem"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_fPMm"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/woodpecker-ci/woodpecker/edit/main/docs/versioned_docs/version-2.7/20-usage/20-workflow-syntax.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_WSBy" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_Q3cy"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/usage/terminology"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Terminology</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/usage/workflows"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Workflows</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_QCCP thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#skip-commits" class="table-of-contents__link toc-highlight">Skip Commits</a></li><li><a href="#steps" class="table-of-contents__link toc-highlight">Steps</a><ul><li><a href="#file-changes-are-incremental" class="table-of-contents__link toc-highlight">File changes are incremental</a></li><li><a href="#image" class="table-of-contents__link toc-highlight"><code>image</code></a></li><li><a href="#commands" class="table-of-contents__link toc-highlight"><code>commands</code></a></li><li><a href="#entrypoint" class="table-of-contents__link toc-highlight"><code>entrypoint</code></a></li><li><a href="#environment" class="table-of-contents__link toc-highlight"><code>environment</code></a></li><li><a href="#secrets" class="table-of-contents__link toc-highlight"><code>secrets</code></a></li><li><a href="#failure" class="table-of-contents__link toc-highlight"><code>failure</code></a></li><li><a href="#when---conditional-execution" class="table-of-contents__link toc-highlight"><code>when</code> - Conditional Execution</a><ul><li><a href="#repo" class="table-of-contents__link toc-highlight"><code>repo</code></a></li><li><a href="#branch" class="table-of-contents__link toc-highlight"><code>branch</code></a></li><li><a href="#event" class="table-of-contents__link toc-highlight"><code>event</code></a></li><li><a href="#cron" class="table-of-contents__link toc-highlight"><code>cron</code></a></li><li><a href="#ref" class="table-of-contents__link toc-highlight"><code>ref</code></a></li><li><a href="#status" class="table-of-contents__link toc-highlight"><code>status</code></a></li><li><a href="#platform" class="table-of-contents__link toc-highlight"><code>platform</code></a></li><li><a href="#matrix" class="table-of-contents__link toc-highlight"><code>matrix</code></a></li><li><a href="#instance" class="table-of-contents__link toc-highlight"><code>instance</code></a></li><li><a href="#path" class="table-of-contents__link toc-highlight"><code>path</code></a></li><li><a href="#evaluate" class="table-of-contents__link toc-highlight"><code>evaluate</code></a></li></ul></li><li><a href="#depends_on" class="table-of-contents__link toc-highlight"><code>depends_on</code></a></li><li><a href="#volumes" class="table-of-contents__link toc-highlight"><code>volumes</code></a></li><li><a href="#detach" class="table-of-contents__link toc-highlight"><code>detach</code></a></li><li><a href="#directory" class="table-of-contents__link toc-highlight"><code>directory</code></a></li></ul></li><li><a href="#services" class="table-of-contents__link toc-highlight"><code>services</code></a></li><li><a href="#workspace" class="table-of-contents__link toc-highlight"><code>workspace</code></a></li><li><a href="#matrix-1" class="table-of-contents__link toc-highlight"><code>matrix</code></a></li><li><a href="#labels" class="table-of-contents__link toc-highlight"><code>labels</code></a><ul><li><a href="#filter-by-platform" class="table-of-contents__link toc-highlight">Filter by platform</a></li></ul></li><li><a href="#variables" class="table-of-contents__link toc-highlight"><code>variables</code></a></li><li><a href="#clone" class="table-of-contents__link toc-highlight"><code>clone</code></a><ul><li><a href="#git-submodules" class="table-of-contents__link toc-highlight">Git Submodules</a></li></ul></li><li><a href="#skip_clone" class="table-of-contents__link toc-highlight"><code>skip_clone</code></a></li><li><a href="#when---global-workflow-conditions" class="table-of-contents__link toc-highlight"><code>when</code> - Global workflow conditions</a></li><li><a href="#depends_on-1" class="table-of-contents__link toc-highlight"><code>depends_on</code></a></li><li><a href="#runs_on" class="table-of-contents__link toc-highlight"><code>runs_on</code></a></li><li><a href="#privileged-mode" class="table-of-contents__link toc-highlight">Privileged mode</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/usage/intro">Usage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/administration/getting-started">Server setup</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/#woodpecker:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://floss.social/@WoodpeckerCI" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/woodpeckerci" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://translate.woodpecker-ci.org/engage/woodpecker-ci/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Translate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/woodpecker-ci/woodpecker" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ci.woodpecker-ci.org/repos/3780" target="_blank" rel="noopener noreferrer" class="footer__link-item">CI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opencollective.com/woodpecker-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Collective<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QqVC"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Woodpecker Authors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>