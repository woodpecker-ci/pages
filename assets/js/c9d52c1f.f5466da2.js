"use strict";(self.webpackChunkwoodpecker=self.webpackChunkwoodpecker||[]).push([["1447"],{56885:function(e){e.exports=JSON.parse('{"name":"Docker Buildx","url":"https://codeberg.org/woodpecker-plugins/docker-buildx","icon":"https://codeberg.org/woodpecker-plugins/docker-buildx/raw/branch/main/docker.svg","description":"plugin to build multiarch Docker images with buildx","docs":"<h1>Overview</h1>\\n<p>Woodpecker CI plugin to build multiarch Docker images with buildx.\\nThis plugin is a fork of <a href=\\"https://github.com/thegeeklab/drone-docker-buildx/\\">thegeeklab/drone-docker-buildx</a> which itself is a fork of <a href=\\"https://github.com/drone-plugins/drone-docker\\">drone-plugins/drone-docker</a>.</p>\\n<h2>Features</h2>\\n<ul>\\n<li>Build without push</li>\\n<li>Use custom registries</li>\\n<li>Build based on existing tags when needed</li>\\n<li>Push to multiple registries/repos</li>\\n<li>Use remote builders</li>\\n</ul>\\n<p>It will automatically generate buildkit configuration to use custom CA certificate if the normal image is used or following conditions are met:</p>\\n<ul>\\n<li>Setting <code>buildkit_config</code> is not set</li>\\n<li>Custom <code>registry</code>/<code>logins</code> value is provided</li>\\n<li>File exists <code>/etc/docker/certs.d/&lt;registry-value&gt;/ca.crt</code></li>\\n</ul>\\n<p>To mount custom CA certificates, the Woodpecker env var <code>WOODPECKER_BACKEND_DOCKER_VOLUMES</code> with value <code>/etc/ssl/certs:/etc/ssl/certs:ro,/etc/docker/certs.d:/etc/docker/certs.d:ro</code> can be used.</p>\\n<h2>Settings</h2>\\n<table>\\n<thead>\\n<tr>\\n<th>Settings Name</th>\\n<th>Default</th>\\n<th>Description</th>\\n</tr>\\n</thead>\\n<tbody><tr>\\n<td><code>dry-run</code></td>\\n<td><code>false</code></td>\\n<td>disables docker push</td>\\n</tr>\\n<tr>\\n<td><code>repo</code></td>\\n<td><em>none</em></td>\\n<td>sets repository name for the image (can be a list)</td>\\n</tr>\\n<tr>\\n<td><code>username</code></td>\\n<td><em>none</em></td>\\n<td>sets username to authenticates with</td>\\n</tr>\\n<tr>\\n<td><code>password</code></td>\\n<td><em>none</em></td>\\n<td>sets password / token to authenticates with</td>\\n</tr>\\n<tr>\\n<td><code>aws_access_key_id</code></td>\\n<td><em>none</em></td>\\n<td>sets AWS_ACCESS_KEY_ID for AWS ECR auth</td>\\n</tr>\\n<tr>\\n<td><code>aws_secret_access_key</code></td>\\n<td><em>none</em></td>\\n<td>sets AWS_SECRET_ACCESS_KEY for AWS ECR auth</td>\\n</tr>\\n<tr>\\n<td><code>aws_region</code></td>\\n<td><code>us-east-1</code></td>\\n<td>sets AWS_DEFAULT_REGION for AWS ECR auth</td>\\n</tr>\\n<tr>\\n<td><code>password</code></td>\\n<td><em>none</em></td>\\n<td>sets password / token to authenticates with</td>\\n</tr>\\n<tr>\\n<td><code>email</code></td>\\n<td><em>none</em></td>\\n<td>sets email address to authenticates with</td>\\n</tr>\\n<tr>\\n<td><code>registry</code></td>\\n<td><code>https://index.docker.io/v1/</code></td>\\n<td>sets docker registry to authenticate with</td>\\n</tr>\\n<tr>\\n<td><code>dockerfile</code></td>\\n<td><code>Dockerfile</code></td>\\n<td>sets dockerfile to use for the image build</td>\\n</tr>\\n<tr>\\n<td><code>tag</code>/<code>tags</code></td>\\n<td><em>none</em></td>\\n<td>sets repository tags to use for the image</td>\\n</tr>\\n<tr>\\n<td><code>platforms</code></td>\\n<td><em>none</em></td>\\n<td>sets target platform for build</td>\\n</tr>\\n<tr>\\n<td><code>provenance</code></td>\\n<td><em>none</em></td>\\n<td>sets provenance for build</td>\\n</tr>\\n<tr>\\n<td><code>remote-builders</code></td>\\n<td><em>none</em></td>\\n<td>sets remote builders for build</td>\\n</tr>\\n<tr>\\n<td><code>ssh-key</code></td>\\n<td><em>none</em></td>\\n<td>sets an ssh key to connect to remote builders</td>\\n</tr>\\n</tbody></table>\\n<h2>auto_tag</h2>\\n<p>If set to true, it will use the <code>default_tag</code> (\\"latest\\") on tag event or default branch.\\nIf it\'s a tag event it will also assume sem versioning and add tags accordingly (<code>x</code>, <code>x.x</code> and <code>x.x.x</code>).\\nIf it\'s not a tag event, and no default branch, automated tags are skipped.</p>\\n<h2>Examples</h2>\\n<pre><code class=\\"language-yaml\\">publish-next-agent:\\n  image: woodpeckerci/plugin-docker-buildx\\n  settings:\\n    repo: woodpeckerci/woodpecker-agent\\n    dockerfile: docker/Dockerfile.agent.multiarch\\n    platforms: windows/amd64,darwin/amd64,darwin/arm64,freebsd/amd64,linux/amd64,linux/arm64/v8\\n    tag: next\\n    username:\\n      from_secret: docker_username\\n    password:\\n      from_secret: docker_password\\n  when:\\n    branch: ${CI_REPO_DEFAULT_BRANCH}\\n    event: push\\n</code></pre>\\n<pre><code class=\\"language-yaml\\">publish:\\n  image: woodpeckerci/plugin-docker-buildx\\n  settings:\\n    platforms: linux/386,linux/amd64,linux/arm/v6,linux/arm64/v8,linux/ppc64le,linux/riscv64,linux/s390x\\n    repo: codeberg.org/${CI_REPO_OWNER}/hello\\n    registry: codeberg.org\\n    tags: latest\\n    username: ${CI_REPO_OWNER}\\n    password:\\n      from_secret: cb_token\\n</code></pre>\\n<pre><code class=\\"language-yaml\\">docker-build:\\n  image: woodpeckerci/plugin-docker-buildx\\n  settings:\\n    repo: codeberg.org/${CI_REPO_OWNER}/hello\\n    registry: codeberg.org\\n    dry-run: true\\n    output: type=oci,dest=${CI_REPO_OWNER}-hello.tar\\n</code></pre>\\n<h2>Advanced Settings</h2>\\n<table>\\n<thead>\\n<tr>\\n<th>Settings Name</th>\\n<th>Default</th>\\n<th>Description</th>\\n</tr>\\n</thead>\\n<tbody><tr>\\n<td><code>mirror</code></td>\\n<td><em>none</em></td>\\n<td>sets a registry mirror to pull images</td>\\n</tr>\\n<tr>\\n<td><code>storage_driver</code></td>\\n<td><em>none</em></td>\\n<td>sets the docker daemon storage driver</td>\\n</tr>\\n<tr>\\n<td><code>storage_path</code></td>\\n<td><code>/var/lib/docker</code></td>\\n<td>sets the docker daemon storage path</td>\\n</tr>\\n<tr>\\n<td><code>bip</code></td>\\n<td><em>none</em></td>\\n<td>allows the docker daemon to bride ip address</td>\\n</tr>\\n<tr>\\n<td><code>mtu</code></td>\\n<td><em>none</em></td>\\n<td>sets docker daemon custom mtu setting</td>\\n</tr>\\n<tr>\\n<td><code>custom_dns</code></td>\\n<td><em>none</em></td>\\n<td>sets custom docker daemon dns server</td>\\n</tr>\\n<tr>\\n<td><code>custom_dns_search</code></td>\\n<td><em>none</em></td>\\n<td>sets custom docker daemon dns search domain</td>\\n</tr>\\n<tr>\\n<td><code>insecure</code></td>\\n<td><code>false</code></td>\\n<td>allows the docker daemon to use insecure registries</td>\\n</tr>\\n<tr>\\n<td><code>ipv6</code></td>\\n<td><code>false</code></td>\\n<td>enables docker daemon IPv6 support</td>\\n</tr>\\n<tr>\\n<td><code>experimental</code></td>\\n<td><code>false</code></td>\\n<td>enables docker daemon experimental mode</td>\\n</tr>\\n<tr>\\n<td><code>debug</code></td>\\n<td><code>false</code></td>\\n<td>enables verbose debug mode for the docker daemon</td>\\n</tr>\\n<tr>\\n<td><code>daemon_off</code></td>\\n<td><code>false</code></td>\\n<td>disables the startup of the docker daemon</td>\\n</tr>\\n<tr>\\n<td><code>buildkit_debug</code></td>\\n<td><code>false</code></td>\\n<td>enables debug output of buildkit</td>\\n</tr>\\n<tr>\\n<td><code>tags_file</code></td>\\n<td><em>none</em></td>\\n<td>overrides the <code>tags</code> option with values in a file named <code>.tags</code>; multiple tags can be specified separated by a newline</td>\\n</tr>\\n<tr>\\n<td><code>context</code></td>\\n<td><code>.</code></td>\\n<td>sets the path of the build context to use</td>\\n</tr>\\n<tr>\\n<td><code>auto_tag</code></td>\\n<td><code>false</code></td>\\n<td>generates tag names automatically based on git branch and git tag, tags supplied via <code>tags</code> are additionally added to the <code>auto_tags</code> without suffix</td>\\n</tr>\\n<tr>\\n<td><code>default_suffix</code>/<code>auto_tag_suffix</code></td>\\n<td><em>none</em></td>\\n<td>generates tag names with the given suffix</td>\\n</tr>\\n<tr>\\n<td><code>default_tag</code></td>\\n<td><code>latest</code></td>\\n<td>overrides the default tag name used when generating with <code>auto_tag</code> enabled</td>\\n</tr>\\n<tr>\\n<td><code>label</code>/<code>labels</code></td>\\n<td><em>none</em></td>\\n<td>sets labels to use for the image in format <code>&lt;name&gt;=&lt;value&gt;</code></td>\\n</tr>\\n<tr>\\n<td><code>default_labels</code>/<code>auto_labels</code></td>\\n<td><code>true</code></td>\\n<td>sets docker image labels based on git information</td>\\n</tr>\\n<tr>\\n<td><code>build_args</code></td>\\n<td><em>none</em></td>\\n<td>sets custom build arguments for the build</td>\\n</tr>\\n<tr>\\n<td><code>build_args_from_env</code></td>\\n<td><em>none</em></td>\\n<td>forwards environment variables as custom arguments to the build</td>\\n</tr>\\n<tr>\\n<td><code>secrets</code></td>\\n<td><em>none</em></td>\\n<td>Sets the build secrets for the build</td>\\n</tr>\\n<tr>\\n<td><code>quiet</code></td>\\n<td><code>false</code></td>\\n<td>enables suppression of the build output</td>\\n</tr>\\n<tr>\\n<td><code>target</code></td>\\n<td><em>none</em></td>\\n<td>sets the build target to use</td>\\n</tr>\\n<tr>\\n<td><code>cache_from</code></td>\\n<td><em>none</em></td>\\n<td>sets configuration for cache source</td>\\n</tr>\\n<tr>\\n<td><code>cache_to</code></td>\\n<td><em>none</em></td>\\n<td>sets configuration for cache export</td>\\n</tr>\\n<tr>\\n<td><code>cache_images</code></td>\\n<td><em>none</em></td>\\n<td>a list of images to use as cache.</td>\\n</tr>\\n<tr>\\n<td><code>pull_image</code></td>\\n<td><code>true</code></td>\\n<td>enforces to pull base image at build time</td>\\n</tr>\\n<tr>\\n<td><code>compress</code></td>\\n<td><code>false</code></td>\\n<td>enables compression of the build context using gzip</td>\\n</tr>\\n<tr>\\n<td><code>config</code></td>\\n<td><em>none</em></td>\\n<td>sets content of the docker daemon json config</td>\\n</tr>\\n<tr>\\n<td><code>purge</code></td>\\n<td><code>true</code></td>\\n<td>enables cleanup of the docker environment at the end of a build</td>\\n</tr>\\n<tr>\\n<td><code>no_cache</code></td>\\n<td><code>false</code></td>\\n<td>disables the usage of cached intermediate containers</td>\\n</tr>\\n<tr>\\n<td><code>add_host</code></td>\\n<td><em>none</em></td>\\n<td>sets additional host:ip mapping</td>\\n</tr>\\n<tr>\\n<td><code>output</code></td>\\n<td><em>none</em></td>\\n<td>sets build output in format<code>type=&lt;type&gt;[,&lt;key&gt;=&lt;value&gt;]</code></td>\\n</tr>\\n<tr>\\n<td><code>logins</code></td>\\n<td><em>none</em></td>\\n<td>option to log into multiple registries</td>\\n</tr>\\n<tr>\\n<td><code>env_file</code></td>\\n<td><em>none</em></td>\\n<td>load env vars from specified file</td>\\n</tr>\\n<tr>\\n<td><code>ecr_create_repository</code></td>\\n<td><code>false</code></td>\\n<td>creates the ECR repository if it does not exist</td>\\n</tr>\\n<tr>\\n<td><code>ecr_lifecycle_policy</code></td>\\n<td><em>none</em></td>\\n<td>AWS ECR lifecycle policy</td>\\n</tr>\\n<tr>\\n<td><code>ecr_repository_policy</code></td>\\n<td><em>none</em></td>\\n<td>AWS ECR repository policy</td>\\n</tr>\\n<tr>\\n<td><code>ecr_scan_on_push</code></td>\\n<td><em>none</em></td>\\n<td>AWS: whether to enable image scanning on push</td>\\n</tr>\\n<tr>\\n<td><code>http_proxy</code></td>\\n<td><em>none</em></td>\\n<td>Set an http proxy if needed. It is also forwarded as build arg called \\"HTTP_PROXY\\".</td>\\n</tr>\\n<tr>\\n<td><code>https_proxy</code></td>\\n<td><em>none</em></td>\\n<td>Set an https proxy if needed. It is also forwarded as build arg called \\"HTTPS_PROXY\\".</td>\\n</tr>\\n<tr>\\n<td><code>no_proxy</code></td>\\n<td><em>none</em></td>\\n<td>Set (sub-)domains to be ignored by proxy settings. It is also forwarded as build arg called \\"NO_PROXY\\".</td>\\n</tr>\\n</tbody></table>\\n<h2>Insecure Settings</h2>\\n<p>These settings are only available in the image versions of the plugin that are tagged with the <code>-insecure</code> suffix.</p>\\n<p>Make sure if you allow external contributions, who can trigger to run this plugin, to use the <a href=\\"https://woodpecker-ci.org/docs/usage/project-settings#require-approval-for\\">require approval for</a> feature!</p>\\n<table>\\n<thead>\\n<tr>\\n<th>Settings Name</th>\\n<th>Default</th>\\n<th>Description</th>\\n</tr>\\n</thead>\\n<tbody><tr>\\n<td><code>buildkit_config</code></td>\\n<td><em>none</em></td>\\n<td>Sets content of the docker <a href=\\"https://github.com/moby/buildkit/blob/master/docs/buildkitd.toml.md\\">buildkit TOML config</a></td>\\n</tr>\\n<tr>\\n<td><code>buildkit_driveropt</code></td>\\n<td><em>none</em></td>\\n<td>Adds one or multiple <code>--driver-opt</code> buildx arguments for the default buildkit builder instance</td>\\n</tr>\\n</tbody></table>\\n<h2>Multi registry push example</h2>\\n<p>Only supported with <code>woodpecker &gt;= 1.0.0</code> (next-da997fa3).</p>\\n<pre><code class=\\"language-yaml\\">settings:\\n  repo: a6543/tmp,codeberg.org/6543/tmp\\n  tag: demo\\n  logins:\\n    - registry: https://index.docker.io/v1/\\n      username: a6543\\n      password:\\n        from_secret: docker_token\\n      mirrors:\\n        - \\"my-docker-mirror-host.local\\"\\n    - registry: https://codeberg.org\\n      username: \\"6543\\"\\n      password:\\n        from_secret: cb_token\\n    - registry: https://&lt;account-id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com\\n      aws_region: &lt;region&gt;\\n      aws_access_key_id:\\n        from_secret: aws_access_key_id\\n      aws_secret_access_key:\\n        from_secret: aws_secret_access_key\\n</code></pre>\\n<h2>Using <code>plugin-docker-buildx</code> behind a proxy</h2>\\n<p>When performing a docker build behind a corporate proxy one needs to pass through the proxy settings to the plugin.</p>\\n<pre><code class=\\"language-yaml\\">variables:\\n  # deployment targets\\n  - &amp;publish_repos \\"codeberg.org/test\\"\\n  # logins for deployment targets\\n  - publish_logins: &amp;publish_logins\\n      - registry: https://codeberg.org\\n        username:\\n          from_secret: CODEBERG_USER\\n        password:\\n          from_secret: CODEBERG_TOKEN\\n\\nsteps:\\n  test:\\n    image: woodpeckerci/plugin-docker-buildx:2\\n    privileged: true\\n    settings:\\n      dry-run: true\\n      repo: *publish_repos\\n      dockerfile: Dockerfile.multi\\n      platforms: linux/amd64\\n      auto_tag: true\\n      logins: *publish_logins\\n      # Adding custom dns server to lookup internal Docker Hub mirror.\\n      # custom_dns:\\n      #   - 192.168.55.31\\n      #   - 192.168.55.32\\n      # Adding an optional Docker Hub mirror for the nested dockerd.\\n      # mirror: https://my-mirror.example.com\\n      http_proxy: \\"http://X.Y.Z.Z:3128\\"\\n      https_proxy: \\"http://X.Y.Z.Z:3128\\"\\n      no_proxy: \\".my-subdomain.com\\"\\n</code></pre>\\n<h2>Using cache images</h2>\\n<p>You can provide a list of images to use for cache.\\nThese cache images are built with mode=max, image-manifest=true, and oci-mediatypes=true.\\nThis is to provide better usage of cache and better compatibility with image stores like Harbor.</p>\\n<pre><code class=\\"language-yaml\\">steps:\\n  build:\\n    image: woodpeckerci/plugin-docker-buildx\\n    settings:\\n      repo: hari/radiant\\n      cache_images:\\n        - hari/radiant:cache\\n        - harbor.example.com/hari/radiant:cache\\n      logins:\\n        - registry: https://index.docker.io/v1/\\n          username: hari\\n          password:\\n            from_secret: docker_password\\n        - registry: https://harbor.example.com\\n          username: hari\\n          password:\\n            from_secret: harbor_password\\n</code></pre>\\n<h2>Using other cache types</h2>\\n<p>You can specify cache_to and cache_from to use specific settings.\\nFor example you can configure an s3 object as cache.</p>\\n<p>More details can be found <a href=\\"https://docs.docker.com/build/cache/backends/\\">in the docker docs</a>.</p>\\n<pre><code class=\\"language-yaml\\">steps:\\n  build:\\n    image: woodpeckerci/plugin-docker-buildx\\n    settings:\\n      repo: hari/radiant\\n      cache_to: type=s3,region=east,bucket=mystuff,name=radiant-cache\\n      cache_from: type=s3,region=east,bucket=mystuff,name=radiant-cache\\n</code></pre>\\n<h2>Using remote builders</h2>\\n<p>When building for multiple platforms, you might want to offload some builds to a remote server, to avoid emulation.\\nTo support this, provide a list build servers to <code>remote-builders</code>.\\nThese servers will need key authentication, so you will also need to provide a (private) SSH key.</p>\\n<pre><code class=\\"language-yaml\\">build:\\n  image: woodpeckerci/plugin-docker-buildx\\n  settings:\\n    platforms: linux/amd64,linux/arm64\\n    repo: codeberg.org/${CI_REPO_OWNER}/hello\\n    registry: codeberg.org\\n    dry-run: true\\n    ssh-key:\\n      from_secret: ssh_key\\n    remote-builders: root@my-amd64-build-server,root@my-arm64-build-server\\n</code></pre>\\n<p>If you want to mix local and remote builders, the list can include \\"local\\":</p>\\n<pre><code class=\\"language-yaml\\">build:\\n  image: woodpeckerci/plugin-docker-buildx\\n  settings:\\n    platforms: linux/amd64,linux/arm64\\n    repo: codeberg.org/${CI_REPO_OWNER}/hello\\n    registry: codeberg.org\\n    dry-run: true\\n    ssh-key:\\n      from_secret: ssh_key\\n    remote-builders: local,root@my-arm64-build-server\\n</code></pre>\\n","tags":["docker","image","container","build"],"author":"Woodpecker Authors","containerImage":"woodpeckerci/plugin-docker-buildx","containerImageUrl":"https://hub.docker.com/r/woodpeckerci/plugin-docker-buildx","verified":true,"iconDataUrl":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI3LjEuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA0MzkgMzA5IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0MzkgMzA5OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6IzFENjNFRDt9Cjwvc3R5bGU+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zNzkuNiwxMTEuN2MtMi4zLTE2LjctMTEuNS0zMS4yLTI4LjEtNDQuM2wtOS42LTYuNWwtNi40LDkuN2MtOC4yLDEyLjUtMTIuMywyOS45LTExLDQ2LjYKCWMwLjYsNS44LDIuNSwxNi40LDguNCwyNS41Yy01LjksMy4zLTE3LjYsNy43LTMzLjIsNy40SDEuN2wtMC42LDMuNWMtMi44LDE2LjctMi44LDY5LDMwLjcsMTA5LjFjMjUuNSwzMC41LDYzLjYsNDYsMTEzLjQsNDYKCWMxMDgsMCwxODcuOC01MC4zLDIyNS4zLTE0MS45YzE0LjcsMC4zLDQ2LjQsMC4xLDYyLjctMzEuNGMwLjQtMC43LDEuNC0yLjYsNC4yLTguNmwxLjYtMy4zbC05LjEtNi4yCglDNDE5LjksMTEwLjgsMzk3LjIsMTA4LjMsMzc5LjYsMTExLjdMMzc5LjYsMTExLjd6IE0yNDAsMGgtNDUuM3Y0MS43SDI0MFYweiBNMjQwLDUwLjFoLTQ1LjN2NDEuN0gyNDBWNTAuMXogTTE4Ni40LDUwLjFoLTQ1LjMKCXY0MS43aDQ1LjNWNTAuMXogTTEzMi45LDUwLjFIODcuNnY0MS43aDQ1LjNWNTAuMXogTTc5LjMsMTAwLjJIMzR2NDEuN2g0NS4zVjEwMC4yeiBNMTMyLjksMTAwLjJIODcuNnY0MS43aDQ1LjNWMTAwLjJ6CgkgTTE4Ni40LDEwMC4yaC00NS4zdjQxLjdoNDUuM1YxMDAuMnogTTI0MCwxMDAuMmgtNDUuM3Y0MS43SDI0MFYxMDAuMnogTTI5My42LDEwMC4yaC00NS4zdjQxLjdoNDUuM1YxMDAuMnoiLz4KPC9zdmc+Cg=="}')}}]);