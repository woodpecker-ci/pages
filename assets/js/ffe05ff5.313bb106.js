/*! For license information please see ffe05ff5.313bb106.js.LICENSE.txt */
"use strict";(self.webpackChunkwoodpecker=self.webpackChunkwoodpecker||[]).push([[5114],{10867:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>_,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var i=n(13274),o=n(74169);const r={toc_max_heading_level:2},c="Bitbucket Datacenter / Server",s={id:"administration/forges/bitbucket_datacenter",title:"Bitbucket Datacenter / Server",description:"Woodpecker comes with experimental support for Bitbucket Datacenter / Server, formerly known as Atlassian Stash.",source:"@site/versioned_docs/version-2.4/30-administration/11-forges/60-bitbucket_datacenter.md",sourceDirName:"30-administration/11-forges",slug:"/administration/forges/bitbucket_datacenter",permalink:"/docs/administration/forges/bitbucket_datacenter",draft:!1,unlisted:!1,editUrl:"https://github.com/woodpecker-ci/woodpecker/edit/main/docs/versioned_docs/version-2.4/30-administration/11-forges/60-bitbucket_datacenter.md",tags:[],version:"2.4",sidebarPosition:60,frontMatter:{toc_max_heading_level:2},sidebar:"tutorialSidebar",previous:{title:"Bitbucket",permalink:"/docs/administration/forges/bitbucket"},next:{title:"Agent configuration",permalink:"/docs/administration/agent-config"}},d={},l=[{value:"Service Account",id:"service-account",level:2},{value:"Registration",id:"registration",level:2},{value:"Configuration",id:"configuration",level:2},{value:"<code>WOODPECKER_BITBUCKET_DC</code>",id:"woodpecker_bitbucket_dc",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_URL</code>",id:"woodpecker_bitbucket_dc_url",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_CLIENT_ID</code>",id:"woodpecker_bitbucket_dc_client_id",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_CLIENT_SECRET</code>",id:"woodpecker_bitbucket_dc_client_secret",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_GIT_USERNAME</code>",id:"woodpecker_bitbucket_dc_git_username",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_GIT_USERNAME_FILE</code>",id:"woodpecker_bitbucket_dc_git_username_file",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_GIT_PASSWORD</code>",id:"woodpecker_bitbucket_dc_git_password",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_GIT_PASSWORD_FILE</code>",id:"woodpecker_bitbucket_dc_git_password_file",level:3},{value:"<code>WOODPECKER_BITBUCKET_DC_SKIP_VERIFY</code>",id:"woodpecker_bitbucket_dc_skip_verify",level:3}];function a(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"bitbucket-datacenter--server",children:"Bitbucket Datacenter / Server"}),"\n",(0,i.jsx)(t.admonition,{type:"warning",children:(0,i.jsx)(t.p,{children:"Woodpecker comes with experimental support for Bitbucket Datacenter / Server, formerly known as Atlassian Stash."})}),"\n",(0,i.jsx)(t.p,{children:"To enable Bitbucket Server you should configure the Woodpecker container using the following environment variables:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-diff",children:"# docker-compose.yml\nversion: '3'\n\nservices:\n  woodpecker-server:\n    [...]\n    environment:\n      - [...]\n+     - WOODPECKER_BITBUCKET_DC=true\n+     - WOODPECKER_BITBUCKET_DC_GIT_USERNAME=foo\n+     - WOODPECKER_BITBUCKET_DC_GIT_PASSWORD=bar\n+     - WOODPECKER_BITBUCKET_DC_CLIENT_ID=xxx\n+     - WOODPECKER_BITBUCKET_DC_CLIENT_SECRET=yyy\n+     - WOODPECKER_BITBUCKET_DC_URL=http://stash.mycompany.com\n\n  woodpecker-agent:\n    [...]\n"})}),"\n",(0,i.jsx)(t.h2,{id:"service-account",children:"Service Account"}),"\n",(0,i.jsxs)(t.p,{children:["Woodpecker uses ",(0,i.jsx)(t.code,{children:"git+https"})," to clone repositories, however, Bitbucket Server does not currently support cloning repositories with an OAuth token. To work around this limitation, you must create a service account and provide the username and password to Woodpecker. This service account will be used to authenticate and clone private repositories."]}),"\n",(0,i.jsx)(t.h2,{id:"registration",children:"Registration"}),"\n",(0,i.jsx)(t.p,{children:'Woodpecker must be registered with Bitbucket Datacenter / Server. In the administration section of Bitbucket choose "Application Links" and then "Create link". Woodpecker should be listed as "External Application" and the direction should be set to "Incomming". Note the client id and client secret of the registration to be used in the configuration of Woodpecker.'}),"\n",(0,i.jsxs)(t.p,{children:["See also ",(0,i.jsx)(t.a,{href:"https://confluence.atlassian.com/bitbucketserver/configure-an-incoming-link-1108483657.html",children:"Configure an incoming link"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(t.p,{children:"This is a full list of configuration options. Please note that many of these options use default configuration values that should work for the majority of installations."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["Default: ",(0,i.jsx)(t.code,{children:"false"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Enables the Bitbucket Server driver."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_url",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_URL"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Configures the Bitbucket Server address."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_client_id",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_CLIENT_ID"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Configures your Bitbucket Server OAUth 2.0 client id."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_client_secret",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_CLIENT_SECRET"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Configures your Bitbucket Server OAUth 2.0 client secret."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_git_username",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_USERNAME"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"This username is used to authenticate and clone all private repositories."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_git_username_file",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_USERNAME_FILE"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Read the value for ",(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_USERNAME"})," from the specified filepath"]}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_git_password",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_PASSWORD"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"The password is used to authenticate and clone all private repositories."}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_git_password_file",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_PASSWORD_FILE"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Default: empty"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Read the value for ",(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_GIT_PASSWORD"})," from the specified filepath"]}),"\n",(0,i.jsx)(t.h3,{id:"woodpecker_bitbucket_dc_skip_verify",children:(0,i.jsx)(t.code,{children:"WOODPECKER_BITBUCKET_DC_SKIP_VERIFY"})}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["Default: ",(0,i.jsx)(t.code,{children:"false"})]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Configure if SSL verification should be skipped."})]})}function _(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},78034:(e,t,n)=>{var i=n(79474),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var i,r={},l=null,a=null;for(i in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(a=t.ref),t)c.call(t,i)&&!d.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:o,type:e,key:l,ref:a,props:r,_owner:s.current}}t.Fragment=r,t.jsx=l,t.jsxs=l},13274:(e,t,n)=>{e.exports=n(78034)},74169:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>s});var i=n(79474);const o={},r=i.createContext(o);function c(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);